<mat-card class="app-card">
  <mat-card-header>
    <strong>{{config.values.references.title}}</strong>
    <span class="fill-remaining-space"></span>
    <button mat-button *ngIf="userService.user.id!=null && !showAdd" button mat-raised-button (click)="showAdd=true">
      Proposer
    </button>
  </mat-card-header>
  <mat-card-content class="app-card-content">
    <app-new-reference (onchange)="add_reference($event)"
                       *ngIf="showAdd">
    </app-new-reference>

    <div *ngIf="!showAdd && categories?.length>0">
      <mat-form-field>
        <mat-label>Filtre</mat-label>
        <mat-select style="font-size: medium" [(ngModel)]="filter" (selectionChange)="refresh()">
          <mat-option *ngFor="let cat of categories" [value]="cat">
            {{cat}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-list>
        <mat-list-item *ngFor="let ref of references">
          <mat-icon mat-list-icon (click)="openMap(ref)">
            my_location
          </mat-icon>
          &nbsp;
          <p>
            <span (click)="openUrl(ref.url)">{{ref.text}}</span><br>
            <small>{{ref.comment}}</small>

            <br>
          </p>
          <span class="fill-remaining-space"></span>
          <button mat-raised-button mat-icon-button (click)="like(ref.id,1)">{{0+ref.likes?.length}}</button>
          /
          <button mat-raised-button mat-icon-button (click)="like(ref.id,-1)">{{0+ref.dislikes?.length}}</button>

          &nbsp;
          <button mat-icon-button mat-raised-button
                  *ngIf="userService.user?.id==ref.owner || userService.user?.email==config.values.admin.email" (click)="del_reference(ref)">
            <mat-icon>
              delete
            </mat-icon>
          </button>

        </mat-list-item>
      </mat-list>
    </div>

  </mat-card-content>
</mat-card>
